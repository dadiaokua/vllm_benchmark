# vLLM 优先级队列测试说明

## 🎯 优先级规则

在vLLM中，**数字越小，优先级越高**：

```
优先级值 | 优先级等级 | 说明
--------|-----------|--------
0       | 超高优先级 | 紧急请求，立即处理
1       | 最高优先级 | 重要请求，优先处理  
3       | 高优先级   | 较重要请求
5       | 中等优先级 | 普通请求
7       | 低优先级   | 不紧急请求
10      | 最低优先级 | 后台任务，最后处理
```

## 🧪 测试场景

### 1. 基础优先级测试 (`test_priority_queuing`)
- 先添加**低优先级**请求 (priority=10)
- 后添加**高优先级**请求 (priority=1) 
- 验证高优先级请求能否插队执行

### 2. 多层次优先级测试 (`test_multi_level_priority`)
- 测试5个不同优先级层次 (0,1,3,5,7,10)
- 按相反顺序添加（先添加低优先级）
- 验证执行顺序是否按优先级排序

### 3. 调度策略对比 (`test_scheduling_policies`)
- `"fcfs"` - 先进先出（忽略优先级）
- `"priority"` - 优先级调度（按优先级执行）

## 📁 相关文件

- `test_vllm_priority_queue.py` - 完整的优先级测试
- `vllm_engine_helper.py` - 引擎管理器（支持调度策略配置）
- `prompt_loader.py` - 随机prompt加载器

## 🔧 使用方法

```bash
cd test
python test_vllm_priority_queue.py
```

测试将验证：
1. ✅ 优先级参数是否被正确识别
2. ✅ 高优先级请求是否能插队
3. ✅ 不同优先级层次的执行顺序
4. ✅ 调度策略的影响效果 